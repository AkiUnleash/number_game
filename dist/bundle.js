(()=>{"use strict";class t{constructor(t,e,n=!0){this.hostElement=document.getElementById(e),this.templateElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,n&&this.attach()}attach(){this.hostElement.insertAdjacentElement("beforeend",this.element)}allremove(){document.getElementById("app").innerHTML=""}}class e{constructor(){this.listeners=[],this.state={question:[],point:0,username:""}}static getInstance(){return e._instance||(e._instance=new e),e._instance}addListener(t){this.listeners.push(t)}setQuestion(){let t=Math.floor(1e5*Math.random()-1).toString().padStart(5,"0");this.state.question=t.toString().split("");for(const t of this.listeners)console.log(this.listeners),t(this.state.question.slice())}getQuestion(){return this.state.question}checkTheAnswer(t){t===this.state.question[0]?(this.state.question.shift(),this.state.point+=100):this.state.point+=-100,0===this.state.question.length&&(this.setQuestion(),this.state.point+=1e3);for(const t of this.listeners)t(this.state.question.slice(),"question"),t(this.state.point,"point")}getPoint(){return this.state.point.toString()}setUsername(t){this.state.username=t}getUsername(){return this.state.username}}const n=e.getInstance();class s extends t{constructor(){super("number-button","oparation",!1),this.configure()}configure(){const t=document.getElementById("oparation");let e=document.createDocumentFragment();for(const t of this._arrayshuffle([...Array(10)].map(((t,e)=>e)))){const n=this.element.cloneNode(!0);n.textContent=t.toString(),n.addEventListener("click",(()=>{this._clickHandler(t.toString())})),e.appendChild(n)}t.appendChild(e)}_clickHandler(t){n.checkTheAnswer(t)}_arrayshuffle(t){for(let e=t.length;1<e;e--){const n=Math.floor(Math.random()*e);[t[n],t[e-1]]=[t[e-1],t[n]]}return t}}class o extends t{constructor(){super("question","question_app",!1),this.assignedState=[],n.setQuestion(),n.addListener(((t,e)=>{"question"===e&&(this.assignedState=t,this.elementRemove(),this.renderContent())})),this.renderContent()}configure(){}renderContent(){const t=n.getQuestion(),e=document.getElementById("question_app");let s=document.createDocumentFragment();for(const e of t){const t=this.element.cloneNode(!0);t.textContent=e,s.appendChild(t)}e.appendChild(s)}elementRemove(){document.getElementById("question_app").innerHTML=""}}class i extends t{constructor(){super("game-screen","app")}renderQuestion(){}configure(){}}class r extends t{constructor(){super("gameover","app"),this.renderPoint()}renderPoint(){document.getElementById("finish__point").textContent=n.getPoint()}configure(){}}class c extends t{constructor(t=30){super("timer","timer-screen"),this.count=t,this.renderTimer()}renderTimer(){const t=setInterval((()=>{this.element.textContent=--this.count+" sec",0===this.count&&(clearTimeout(t),this.allremove(),new r)}).bind(void 0),1e3)}configure(){}}class a extends t{constructor(){super("point","header"),this._point="",n.addListener(((t,e)=>{"point"===e&&(this._point=t.toString().padStart(6,"0"),this.renderPoint())}))}renderPoint(){this.element.textContent=this._point.toString()}configure(){}}class u extends t{constructor(){super("username","header"),this.element.textContent=n.getUsername()}renderQuestion(){}configure(){}}class h extends t{constructor(t=3){super("standby","app"),this._count=t,this.configure()}configure(){return t=this,e=void 0,s=function*(){let t=yield this._countDown(this._count);this.element.textContent=t.toString(),t=yield this._countDown(t),this.element.textContent=t.toString(),t=yield this._countDown(t),this._gameScreenShow()},new((n=void 0)||(n=Promise))((function(o,i){function r(t){try{a(s.next(t))}catch(t){i(t)}}function c(t){try{a(s.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}a((s=s.apply(t,e||[])).next())}));var t,e,n,s}_countDown(t){return new Promise((e=>{setTimeout((function(){e(--t)}),1e3)}))}_gameScreenShow(){this.element.remove(),new i,new u,new a,new o,new s,new c}}class l extends t{constructor(){super("start-button","startbutton-postion"),this.configure()}configure(){this.element.addEventListener("click",this.clickHandler.bind(this))}clickHandler(t){const e=document.getElementById("name_field");n.setUsername(e.value),this.allremove(),new h}}new class extends t{constructor(){super("start-screen","app"),new l}configure(){}}})();